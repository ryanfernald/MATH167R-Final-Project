---
title: "Final Project"
author: "Ryan Fernald, Eden Kidane"
format: 
  html:
    embed-resources: true
    code-tools: true
    code-summary: "Code"
---

```{r}
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(patchwork)
```

```{r}

x <- "https://raw.githubusercontent.com/ryanfernald/MATH167R-Final-Project/main/DATA/smartphone_usage_time_and_health_variable_outcomes.csv"

data <- read.csv(x)

head(data)
```

```{r}
filtered_data <- data[, c(1:2, seq(4, ncol(data), by = 2))]
head(filtered_data)
```

```{r}
ggplot(data = filtered_data, aes(x = Usage,
                                 y = Stress_perception)) +
  geom_bar(stat = "identity", fill = "darkcyan") +
  theme_wsj(base_size = 8) +
      theme(axis.title=element_text(size=12)) + 
  labs(title = "Cellphone usage and \nStress perception",
       x = "Screen Time (hours/day)",
       y = "Stress Level")
```

```{r}
ggplot(data = filtered_data, aes(x = Usage,
                                 y = Sleep_dissatisfaction)) +
  geom_bar(stat = "identity", fill = "darkred") +
  theme_wsj(base_size = 8) +
      theme(axis.title=element_text(size=12)) + 
  labs(title = "Cellphone usage and \nSleep Dissatisfaction",
       x = "Screen Time (hours/day)",
       y = "Sleep Dissatisfaction")
```

```{r}
ggplot(data = filtered_data, aes(x = Usage,
                                 y = Depressive_symptoms)) +
  geom_bar(stat = "identity", fill = "brown") +
  theme_wsj(base_size = 8) +
      theme(axis.title=element_text(size=12)) + 
  labs(title = "Cellphone usage and \nDepressive Symptoms",
       x = "Screen Time (hours/day)",
       y = "Depressive Symptoms")
```

```{r}
ggplot(data = filtered_data, aes(x = Usage,
                                 y = Alcohol)) +
  geom_bar(stat = "identity", fill = "coral4") +
  theme_wsj(base_size = 8) +
      theme(axis.title=element_text(size=12)) + 
  labs(title = "Cellphone usage and \n Alcohol",
       x = "Screen Time (hours/day)",
       y = "Alcohol")
```

```{r}
ggplot(data = filtered_data, aes(x = Usage,
                                 y = Smartphone_overdependence)) +
  geom_bar(stat = "identity", fill = "aquamarine4") +
  theme_wsj(base_size = 8) +
      theme(axis.title=element_text(size=12)) + 
  labs(title = "Cellphone usage and \n Smartphone overdependence",
       x = "Screen Time (hours/day)",
       y = "Smartphone overdependence")
```


```{r, fig.height = 7, fig.width = 10}
colors <- c("darkred", "darkcyan", "darkblue", "darkgreen", "darkorange", "purple", "darkgray", "darkmagenta", "darkolivegreen", "darkslategray")

# Split variables into two sets
vars_set1 <- names(filtered_data)[-1][1:5]
vars_set2 <- names(filtered_data)[-1][6:10]

# Function to create plots for a set of variables
create_plots <- function(vars, title_prefix) {
  plots <- lapply(vars, function(var) {
    ggplot(data = filtered_data, aes_string(x = "Usage", y = var)) +
      geom_bar(stat = "identity", fill = colors[match(var, names(filtered_data)[-1])]) +
      labs(x = "Screen Time",
           y = var) +
      theme(plot.title = element_text(hjust = 0.3, size = 10)) +
      ggtitle(paste(var))
  })
  multiplot <- wrap_plots(plots, nrow = 2, width = 10, height = 10)
  return(multiplot)
}

# Create plots for set 1
multiplot_set1 <- create_plots(vars_set1, "Set 1:")

# Save set 1
ggsave("plots_set1.png", multiplot_set1, width = 10, height = 10)

# Create plots for set 2
multiplot_set2 <- create_plots(vars_set2, "Set 2:")

# Save set 2
ggsave("plots_set2.png", multiplot_set2, width = 10, height = 10)

multiplot_set1
multiplot_set2
```



```{r}
data <- data.frame(
Day_type = c(rep("Weekday", 3), rep("Weekend", 3), rep("Daily Average", 3)),
Time_Category = rep(c("0 - 2 h/day", "2 - 4 h/day", "4 + h/day"), 3),
Count = c(31481, 17775, 12605, 18713, 15778, 27910, 218763, 20568, 19420)
)
# Bar Plot
bar_plot <- ggplot(data, aes(x = Day_type, y = Count, fill = Time_Category)) +
geom_bar(stat = "identity") +
labs(title = "Smartphone Usage by Day Type and Time Category",
x = "Day Type",
y = "Count") +
theme_minimal() +
theme(legend.position = "bottom")
# Stacked Bar Plot
stacked_bar_plot <- ggplot(data, aes(x = Day_type, y = Count, fill = Time_Category)) +
geom_bar(stat = "identity") +
labs(title = "Smartphone Usage by Day Type and Time Category",
x = "Day Type",
y = "Count") +
theme_minimal() +
theme(legend.position = "bottom") +
coord_flip()


# Pie Chart
pie_chart <- ggplot(data, aes(x = "", y = Count, fill = Time_Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
labs(title = "Proportion of Smartphone Usage by Time Category",
x = NULL,
y = NULL) +
theme_void() +
theme(legend.position = "right")
# Display the graphs
print(bar_plot)
print(stacked_bar_plot)


print(pie_chart)
library(ggplot2)
# Create a dataframe with the data
data <- data.frame(
Day_type = c(rep("Weekday", 3), rep("Weekend", 3), rep("Daily Average", 3)),
Time_Category = rep(c("0 - 2 h/day", "2 - 4 h/day", "4 + h/day"), 3),
Count = c(31481, 17775, 12605, 18713, 15778, 27910, 218763, 20568, 19420)
)

library(ggplot2)
# Create a dataframe with the data
data <- data.frame(
Day_type = c(rep("Weekday", 3), rep("Weekend", 3), rep("Daily Average", 3)),
Time_Category = rep(c("0 - 2 h/day", "2 - 4 h/day", "4 + h/day"), 3),
Count = c(31481, 17775, 12605, 18713, 15778, 27910, 218763, 20568, 19420)
)

# Density Plot
density_plot <- ggplot(data, aes(x = Count, fill = Time_Category)) +
geom_density(alpha = 0.5) +
labs(title = "Density of Smartphone Usage by Time Category",
x = "Count",
y = "Density") +
theme_minimal()
print(density_plot)
library(ggplot2)
# Create a dataframe with the data
data <- data.frame(
Day_type = c(rep("Weekday", 3), rep("Weekend", 3), rep("Daily Average", 3)),
Time_Category = rep(c("0 - 2 h/day", "2 - 4 h/day", "4 + h/day"), 3),
Count = c(31481, 17775, 12605, 18713, 15778, 27910, 218763, 20568, 19420)
)


# Remove Daily Average row for heatmap
no_daily <- data[data$Day_type != "Daily Average", ]

# Heatmap
heatmap <- ggplot(no_daily, aes(x = Time_Category, y = Day_type, fill = Count)) +
geom_tile() +
labs(title = "Smartphone Usage Heatmap",
x = "Time Category",
y = "Day Type",
fill = "Count") +
theme_minimal()
print(heatmap)
# Convert data to wide format for heatmap
library(tidyr)
library(ggplot2)
# Create a dataframe with the data
data <- data.frame(
Day_type = c(rep("Weekday", 3), rep("Weekend", 3), rep("Daily Average", 3)),
Time_Category = rep(c("0 - 2 h/day", "2 - 4 h/day", "4 + h/day"), 3),
Count = c(31481, 17775, 12605, 18713, 15778, 27910, 218763, 20568, 19420)
)


```
```{r}
h <- "https://raw.githubusercontent.com/ryanfernald/MATH167R-Final-Project/main/DATA/Percentages%20stats%20health%20outcomes.csv"
data <- read.csv(h)
```

```{r}
data_long <- data |>
  pivot_longer(cols = -Usage, 
               names_to = "Health_Outcome", 
               values_to = "Percentage")

data_long$Health_Outcome <- factor(data_long$Health_Outcome, levels = unique(data_long$Health_Outcome))
```

```{r, fig.height = 7, fig.width = 10}
ggplot(data_long, aes(x = Health_Outcome, y = Percentage, fill = Usage, label = Percentage)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(position = position_dodge(width = 0.9), size = 3, vjust = -0.5) +  # Add labels directly on top of bars with dodge position
  scale_fill_manual(values = c("< 4 Hours per day" = "maroon", "> 4 Hours Per day" = "darkcyan")) +
  labs(
    title = "Comparison of Health Outcomes by Smartphone Usage",
    x = "Health Outcome",
    y = "Percentage (%)"
  ) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(hjust = 0.5)
  )
```

```{r}
w <- "https://raw.githubusercontent.com/ryanfernald/MATH167R-Final-Project/main/DATA/Depression%2C%20anxiety%2C%20and%20smartphone%20addiction%20in%20university%20students-%20A%20cross%20sectional%20study.csv"
wdata <- read.csv(w)
wdata[wdata == "."] <- NA
```

## Inferential analysis 

# What are the health risks associated with excessive smartphone and social media use leading to isolation, and how does this impact different demographic groups in terms of social interactions and behaviors?

```{r}
ggplot(wdata, aes(x = as.numeric(ExcessveSmrtPhn_Use), y = as.numeric(TotAddiction_Score))) +
  geom_point() +
  geom_smooth(method = "lm", color = "blue")+theme(axis.text.y=element_text(size=5))
```

```{r}
wdata <- na.omit(wdata)

lm_model <- lm(as.numeric(TotAddiction_Score) ~ as.numeric(ExcessveSmrtPhn_Use) , data = wdata, na.action = na.exclude)
#lm(y,x,data) this is the format for the graph we did


lm_model

summary(lm_model)
# why this model and why it relates
#what is the model 
# what x is and y
# after fit the model here r the estimated perametters
#interperet the perametters
# look at a hypothsis test for beta 1  

# look at p value for hypothesis testing 

#Intersept and slope 
```


```{r}
ggplot(wdata, aes(x = as.numeric(AgeStrt_useSmrtPhne), y = as.numeric(TotAddiction_Score))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "blue")+theme(axis.text.y=element_text(size=5))
```

```{r}
lm_model <- lm(as.numeric(AgeStrt_useSmrtPhne) ~ as.numeric(TotAddiction_Score), data = wdata, na.action = na.exclude)

lm_model
```

